---
import { Image } from "astro:assets";
import { ArrowRight } from "lucide-astro";

// import media2 from "../assets/media2.webp";
import media3 from "../assets/nasdaq-billboard.webp";
import media4 from "../assets/Boston 2025-3786.jpg";
import media5 from "../assets/Boston 2025-3808.jpg";
import media6 from "../assets/NYCityBar.jpg";

const base = import.meta.env.BASE_URL;

const mediaItems = [
  {
    type: "video",
    src: `${base}videos/surgeon-general-meeting.mp4`,
    poster: `${base}images/surgeon-general-meeting-poster.webp`,
    caption: "Video: Professional public health meeting",
    fit: "cover",
  },
  {
    type: "video",
    src: `${base}videos/astronaut_interview.mp4`,
    poster: `${base}images/media2-poster.webp`,
    caption: "Video: I had the honor of interviewing NASA astronaut Mike Hopkins, where we discussed how critical nutrition and exercise are to the success of every space mission and how those same principles apply here on Earth. Just like astronauts, children thrive when their bodies are fueled well and supported with movement, setting the foundation for focus, resilience, and healthy bodies.",
    fit: "cover",
  },
  {
    type: "image",
    src: media5,
    alt: "Dr. Okonkwo speaking at a community event",
    caption: "Speaking at the Harvard Club of Boston provided an opportunity to share how direct access to physicians and personalized, trust-based care models lead to better outcomes and more sustainable health for patients and families.",
    fit: "cover",
  },
  {
    type: "image",
    src: media4,
    alt: "Dr. Okonkwo participating in a professional panel",
    caption: "Speech at Harvard Club of Boston: Discussing how giving patients direct access to physicians and building personalized, trusted relationships leads to stronger outcomes and lasting health.",
    fit: "cover",
  },
  {
    type: "image",
    src: media6,
    alt: "Dr. Okonkwo participating in a professional panel at New York Academy of Medicine",
    caption: "It was an honor to speak at the New York Academy of Medicine on how children thrive when families have direct access to their pediatrician. We explored how a holistic approach to ADHD focuses on identifying root causes not just managing symptoms.",
    fit: "cover",
  },
  {
    type: "image",
    src: media3,
    alt: "Dr. Okonkwo featured on Nasdaq billboard in Times Square, New York City",
    caption: "Featured on Nasdaq billboard in Times Square, NYC",
    fit: "contain",
  },
];

---

<section class="border-y border-slate-200 bg-slate-50">
  <!-- <a
    href={`${base}about-dr-okonkwo`}
    class="block focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-600"
    aria-label="Learn more about Dr. Okonkwo"
  > -->
  <div class="mx-auto max-w-7xl px-4 py-10 sm:py-10">
    <div class="text-center space-y-2">
      <p class="text-xs font-semibold uppercase tracking-wide text-brand-700">
        Community & Media
      </p>
      <h3 class="text-base font-semibold text-slate-900">
        Sharing pediatric expertise beyond the clinic
      </h3>
      <p class="mx-auto max-w-xl text-sm text-slate-600">
        Dr. Okonkwo is regularly invited to speak and share insights on pediatric
        health, holistic care, and parent education.
      </p>
    </div>

    <!-- Media carousel -->
    <div class="mt-6">
      <div class="swiper credibility-swiper">
        <div class="swiper-wrapper">

          {mediaItems.map((item) => (
            <div class="swiper-slide">
              <figure class={`space-y-2 ${item.fit === "contain" ? "flex flex-col items-center justify-center h-full" : ""}`}>

                <!-- Media container -->
                <div
                  class={`overflow-hidden rounded-xl ring-brand-700/10 
                    ${item.fit === "contain"
                      ? "ring-0 bg-slate-100 max-w-45 max-h-50 sm:max-w-45 sm:max-h-57 flex items-center justify-center"
                      : "aspect-video ring-1 bg-slate-100"}`}
                >

                  {item.type === "video" ? (
                    <video
                      controls
                      preload="metadata"
                      class="h-full w-full object-cover aspect-video"
                      poster={item.poster}
                    >
                      <source src={typeof item.src === "string" ? item.src : ""} type="video/mp4" />
                      Your browser does not support the video tag.
                    </video>
                  ) : (
                    <Image
                      src={item.src as ImageMetadata}
                      alt={item.alt ?? ""}
                      class={item.fit === "contain"
                        ? "h-full w-auto object-contain "
                        : "h-full w-full object-cover"}
                      loading="lazy"
                      inferSize
                    />
                  )}
                </div>

                <!-- Caption -->
                <figcaption class="text-xs text-slate-500">
                  {item.caption}
                </figcaption>
              </figure>
            </div>
          ))}

        </div>

        <!-- Pagination -->
        <div class="swiper-page mt-5 flex items-center justify-center"></div>

        <!-- Navigation buttons --> 
        <div class="mt-4 mb-4 flex items-center justify-end gap-4 pr-5 sm:pr-10">
          <button
          type="button" 
          class="credibility-prev-btn control-btn flex h-10 w-10 items-center justify-center rounded-full 
                bg-slate-800 hover:bg-slate-700 shadow-md transition-colors duration-200 
                focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-500 
                focus-visible:ring-offset-2"
          aria-label="button to scroll left card">
            <span class="sr-only">Previous slide</span>
            <svg
              class="h-6 w-6 text-slate-100"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
              stroke-width="2.5"
            >
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
            </svg>
          </button>

          <button
          type="button" 
          class="credibility-next-btn control-btn flex h-10 w-10 items-center justify-center rounded-full 
                bg-slate-200 hover:bg-slate-300 shadow-md transition-colors duration-200 
                focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-500 
                focus-visible:ring-offset-2"
          aria-label="button to scroll right card">
            <span class="sr-only">Next slide</span>
            <svg
              class="h-6 w-6 transition-transform text-slate-700"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
              stroke-width="2.5"
            >
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" />
            </svg>
          </button>
        </div>
      </div>
      <!-- <p class="mt-3 text-xs text-slate-500 text-center">Swipe to view highlights.</p> -->
    </div>

    <div class="mt-4 text-center text-xs font-medium text-brand-600">
      <a
        href={`${base}about-dr-okonkwo`}
        class="hover:underline focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-600 focus-visible:ring-offset-2"
      >
        Learn more about Dr. Okonkwo 
        <ArrowRight
          class="inline h-4 w-4 transition-transform group-hover:translate-x-0.5"
          stroke-width="1.75"
          aria-hidden="true" 
        />
      </a>
    </div>

    <script>
      import Swiper from "swiper";
      import { Navigation, Pagination, Keyboard, A11y } from "swiper/modules";

      const el = document.querySelector(".credibility-swiper") as HTMLElement | null;

      const pauseAllVideos = () => {
        if (!el) return;
        el.querySelectorAll("video").forEach((v) => {
          try { v.pause(); } catch {}
        });
      };

      if (el) {
        const swiper = new Swiper(el, {
          modules: [Navigation, Pagination, Keyboard, A11y],
          slidesPerView: 1,
          spaceBetween: 16,
          loop: true,
          speed: 650,
          keyboard: { enabled: true },
          pagination: { el: el.querySelector(".swiper-page") as HTMLElement | null, clickable: true },
          navigation: {
            nextEl: el.querySelector(".credibility-next-btn") as HTMLElement | null,
            prevEl: el.querySelector(".credibility-prev-btn") as HTMLElement | null,
          },
          a11y: { enabled: true },
          breakpoints: {
            640: { slidesPerView: 2, spaceBetween: 18 },
            1024: { slidesPerView: 3, spaceBetween: 20 },
          },
          on: {
            slideChangeTransitionStart: () => pauseAllVideos(),
          },
        });

        // Also pause videos if user clicks outside controls, etc.
        el.addEventListener("focusout", pauseAllVideos);
      }
    </script>
    

    
  </div>
</section>
